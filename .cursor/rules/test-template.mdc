---
description: Test file structure and expectations for every facet.
globs:
  - "test/facets/**/*.ts"
mode: always
---

# Test Structure for Facets

Each facet must include a full test file:

## Required Tests:
- [ ] Multi-user interactions (min. 3 simulated addresses)
- [ ] Permission boundaries (role vs non-role)
- [ ] Storage correctness before and after actions
- [ ] Edge case stress test (0, max values, reentrancy)
- [ ] Gas usage snapshot
- [ ] All outputs asserted (no unchecked events or states)
- [ ] Economic flows (balance change assertions)

Test files must be named as: `test/facets/FacetName.test.ts`
