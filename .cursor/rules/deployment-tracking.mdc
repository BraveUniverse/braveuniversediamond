---
description: Deployment tracking rules and structure for BraveUniverse Diamond system.
globs:
  - "**/*.ts"
  - "**/*.js"
  - "scripts/**/*.ts"
mode: always
---

# DEPLOYMENT TRACKING RULES

## MANDATORY TRACKING
- ✅ Every deployment **must be recorded** in `deployments/<network-name>/deployment-log.json`.
- ✅ Each log entry must include:
  - `timestamp`
  - `deployer`
  - `contractName`
  - `address`
  - `txHash`
  - `gasUsed`
  - `status`
- ✅ Failed deployments **must still be logged**, including `error` reason.
- ✅ For **Diamond upgrades**, log both old and new facet addresses for full traceability.

## FILE STRUCTURE

Example JSON format:

```json
{
  "network": "luksoTestnet",
  "chainId": 4201,
  "deployments": [
    {
      "timestamp": "2024-12-19T15:30:00Z",
      "deployer": "0x...",
      "contractName": "GridottoFacet",
      "address": "0x...",
      "txHash": "0x...",
      "gasUsed": "1234567",
      "status": "success"
    }
  ]
}
AUTOMATED CHECKS
	•	✅ Scripts must check if a contract already exists at the address before redeploying.
	•	✅ If contract is missing or broken:
	•	Prompt user for redeployment confirmation.
	•	Proceed to auto-redeploy if confirmed.
	•	✅ After deployment, generate a summary including contract names and gas usage.
	•	✅ Export contract addresses to addresses.json for convenient imports across scripts.

VERIFICATION
	•	✅ All deployed contracts must be verified on the appropriate block explorer.
	•	✅ Verification status must be tracked in the deployment log (verified: true/false).
	•	✅ Contract ABI must be exported to /abis/<ContractName>.json.

✅ REMEMBER: A deployment is NOT considered complete until:
	•	It is logged
	•	It is verified
	•	Its ABI is exported