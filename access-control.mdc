---
description: Access control testing and assertion rules.
globs:
  - "test/facets/**/*.ts"
mode: always
---

# Access Control Rules

Every public/external function must:

- Assert only authorized roles can call (where applicable)
- Reject unauthorized addresses with revert checks
- Simulate privilege escalation attempts and fail

## Example assertion pattern:
```ts
await expect(contract.connect(nonAdmin).restrictedFunc())
  .to.be.revertedWith("NotAuthorized");
